<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
WireIt Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="Container.js Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b>WireIt</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>Container.js</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		This class represents the module and contains multiple terminals.<BR/><BR/>
	
</p>

<hr>


    <table border="1" cellpadding="3" cellspacing="0" width="100%">
    <tr bgcolor="#CCCCFF" class="TableHeadingColor">
    <td colspan=2><font size="+2">
    
        <b>Class Summary</b>
    
    </font></td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="WireIt/Container.html">WireIt.Container</a></b></td>
    <td>WireIt.Container
 </td>
    </tr>
    
    </table>
    <hr/> 


<!-- ========== METHOD SUMMARY =========== -->

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview"><span class="comment">/**
 * <span class="attrib">@fileoverview</span> This class represents the module and contains multiple terminals.
 */</span>
<span class="comment">/**
 * <span class="attrib">@class</span> WireIt.Container
 * <span class="attrib">@constructor</span>
 * <span class="attrib">@param</span> {Object}   config      Configuration object (see properties)
 * <span class="attrib">@param</span> {WireIt.Layer}   layer The WireIt.Layer (or subclass) instance that contains this container
 */</span>
WireIt.Container = <span class="reserved">function</span>(config, layer) {
   
   <span class="comment">/**
    * Main config object
    * &lt;ul&gt;
    *    &lt;li&gt;terminals: list of the terminals configuration&lt;/li&gt;
    *    &lt;li&gt;draggable: boolean that enables drag'n drop on this container (default: true)&lt;/li&gt;
    *    &lt;li&gt;className: CSS class name for the container element (default 'WireIt-Container')&lt;/li&gt;
    *    &lt;li&gt;position: initial position of the container&lt;/li&gt;
    *    &lt;li&gt;ddHandle: (only if draggable) boolean indicating we use a handle for drag'n drop (default true)&lt;/li&gt;
    *    &lt;li&gt;ddHandleClassName: CSS class name for the drag'n drop handle (default 'WireIt-Container-ddhandle')&lt;/li&gt;
    *    &lt;li&gt;resizable: boolean that makes the container resizable (default true)&lt;/li&gt;
    *    &lt;li&gt;resizeHandleClassName: CSS class name for the resize handle (default 'WireIt-Container-resizehandle')&lt;/li&gt;
    *    &lt;li&gt;width: initial width of the container (no default so it autoadjusts to the content)&lt;/li&gt;
    *    &lt;li&gt;height: initial height of the container (default 100)&lt;/li&gt;
    *    &lt;li&gt;close: display a button to close the container (default true)&lt;/li&gt;
    *    &lt;li&gt;closeButtonClassName: CSS class name for the close button (default "WireIt-Container-closebutton")&lt;/li&gt;
    * &lt;/ul&gt;
    */</span>
   <span class="reserved">this</span>.config = config || {};
   <span class="reserved">this</span>.config.terminals = <span class="reserved">this</span>.config.terminals || [];
   <span class="reserved">this</span>.config.draggable = (typeof <span class="reserved">this</span>.config.draggable == <span class="literal">"undefined"</span>) ? true : <span class="reserved">this</span>.config.draggable ;
   <span class="reserved">this</span>.config.position = <span class="reserved">this</span>.config.position || [100,100];
   <span class="reserved">this</span>.config.className = <span class="reserved">this</span>.config.className || <span class="literal">'WireIt-Container'</span>;
   
   <span class="reserved">this</span>.config.ddHandle = (typeof <span class="reserved">this</span>.config.ddHandle == <span class="literal">"undefined"</span>) ? true : <span class="reserved">this</span>.config.ddHandle;
   <span class="reserved">this</span>.config.ddHandleClassName = <span class="reserved">this</span>.config.ddHandleClassName || <span class="literal">"WireIt-Container-ddhandle"</span>;
   
   <span class="reserved">this</span>.config.resizable = (typeof <span class="reserved">this</span>.config.resizable == <span class="literal">"undefined"</span>) ? true : <span class="reserved">this</span>.config.resizable;
   <span class="reserved">this</span>.config.resizeHandleClassName = <span class="reserved">this</span>.config.resizeHandleClassName || <span class="literal">"WireIt-Container-resizehandle"</span>;
   
   <span class="reserved">this</span>.config.width = <span class="reserved">this</span>.config.width; <span class="comment">// no default</span>
   <span class="reserved">this</span>.config.height = <span class="reserved">this</span>.config.height || 100;
   
   <span class="reserved">this</span>.config.close = (typeof <span class="reserved">this</span>.config.close == <span class="literal">"undefined"</span>) ? true : <span class="reserved">this</span>.config.close;
   <span class="reserved">this</span>.config.closeButtonClassName = <span class="reserved">this</span>.config.closeButtonClassName || <span class="literal">"WireIt-Container-closebutton"</span>;
   
   <span class="comment">/**
    * the WireIt.Layer object that schould contain this container
    */</span>
   <span class="reserved">this</span>.layer = layer;
   
   <span class="comment">/**
    * List of the terminals
    */</span>
   <span class="reserved">this</span>.terminals = [];
   
   <span class="comment">/**
    * List of all the wires connected to this container terminals
    */</span>
   <span class="reserved">this</span>.wires = [];
   
   <span class="comment">/**
    * Container DOM element
    */</span>
   <span class="reserved">this</span>.el = null;
   
   <span class="comment">/**
    * Body element
    */</span>
   <span class="reserved">this</span>.bodyEl = null;
   
   <span class="comment">/**
    * Event that is fired when a wire is added
    * You can register this event with myTerminal.eventAddWire.subscribe(function(e,params) { var wire=params[0];}, scope);
    */</span>
   <span class="reserved">this</span>.eventAddWire = new YAHOO.util.CustomEvent(<span class="literal">"eventAddWire"</span>);
   
   <span class="comment">/**
    * Event that is fired when a wire is removed
    * You can register this event with myTerminal.eventRemoveWire.subscribe(function(e,params) { var wire=params[0];}, scope);
    */</span>
   <span class="reserved">this</span>.eventRemoveWire = new YAHOO.util.CustomEvent(<span class="literal">"eventRemoveWire"</span>);
   
   <span class="comment">// Render the div object</span>
   <span class="reserved">this</span>.render();
   
   <span class="comment">// Init the terminals</span>
   <span class="reserved">this</span>.initTerminals( <span class="reserved">this</span>.config.terminals);
   
	<span class="comment">// Make the container draggable</span>
	<span class="reserved">if</span>(<span class="reserved">this</span>.config.draggable) {
		   
	   <span class="reserved">if</span>(<span class="reserved">this</span>.config.resizable) {
      	<span class="comment">// Make resizeable   </span>
      	<span class="reserved">this</span>.ddResize = new WireIt.util.DDResize(<span class="reserved">this</span>);
      	<span class="reserved">this</span>.ddResize.eventResize.subscribe(<span class="reserved">this</span>.onResize, <span class="reserved">this</span>);
	   }
	   
	   <span class="comment">// Use the drag'n drop utility to make the container draggable</span>
	   <span class="reserved">this</span>.dd = new WireIt.util.DD(<span class="reserved">this</span>.terminals,<span class="reserved">this</span>.el);
	   
	   <span class="comment">// Sets ddHandle as the drag'n drop handle</span>
	   <span class="reserved">if</span>(<span class="reserved">this</span>.config.ddHandle) {
   	   <span class="reserved">this</span>.dd.setHandleElId(<span class="reserved">this</span>.ddHandle);
	   }
	   
	   <span class="comment">// Mark the resize handle as an invalid drag'n drop handle and vice versa</span>
	   <span class="reserved">if</span>(<span class="reserved">this</span>.config.resizable) {
   	   <span class="reserved">this</span>.dd.addInvalidHandleId(<span class="reserved">this</span>.ddResizeHandle);
      	<span class="reserved">this</span>.ddResize.addInvalidHandleId(<span class="reserved">this</span>.ddHandle);
	   }
   }
   
};

<span class="comment">/**
 * Function called when the container is being resized.
 * It doesn't do anything, so please override it.
 */</span>
WireIt.Container.<span class="reserved">prototype</span>.onResize = <span class="reserved">function</span>(event, args) {
   var size = args[0];
};

<span class="comment">/**
 * Render the dom of the container
 */</span>
WireIt.Container.<span class="reserved">prototype</span>.render = <span class="reserved">function</span>() {
   
   <span class="comment">// Create the element</span>
   <span class="reserved">this</span>.el = WireIt.cn(<span class="literal">'div'</span>, {className: <span class="reserved">this</span>.config.className}, {width: <span class="reserved">this</span>.config.width+<span class="literal">"px"</span>, height: <span class="reserved">this</span>.config.height+<span class="literal">"px"</span>});
   
   <span class="comment">// Adds a handler for mousedown so we can notice the layer</span>
   YAHOO.util.Event.addListener(<span class="reserved">this</span>.el, <span class="literal">"mousedown"</span>, <span class="reserved">this</span>.onMouseDown, <span class="reserved">this</span>, true);
   
   <span class="reserved">if</span>(<span class="reserved">this</span>.config.ddHandle) {
      <span class="comment">// Create the drag/drop handle</span>
   	<span class="reserved">this</span>.ddHandle = WireIt.cn(<span class="literal">'div'</span>, {className: <span class="reserved">this</span>.config.ddHandleClassName});
   	<span class="reserved">this</span>.el.appendChild(<span class="reserved">this</span>.ddHandle);
   }
   
   <span class="comment">// Create the body element</span>
   <span class="reserved">this</span>.bodyEl = WireIt.cn(<span class="literal">'div'</span>, {className: <span class="literal">"body"</span>});
   <span class="reserved">this</span>.el.appendChild(<span class="reserved">this</span>.bodyEl);
   
   <span class="reserved">if</span>(<span class="reserved">this</span>.config.resizable) {
      <span class="comment">// Create the resize handle</span>
   	<span class="reserved">this</span>.ddResizeHandle = WireIt.cn(<span class="literal">'div'</span>, {className: <span class="reserved">this</span>.config.resizeHandleClassName} );
   	<span class="reserved">this</span>.el.appendChild(<span class="reserved">this</span>.ddResizeHandle);
   }
   
   <span class="reserved">if</span>(<span class="reserved">this</span>.config.close) {
      <span class="comment">// Close button</span>
      <span class="reserved">this</span>.closeButton = WireIt.cn(<span class="literal">'div'</span>, {className: <span class="reserved">this</span>.config.closeButtonClassName} );
      <span class="reserved">this</span>.el.appendChild(<span class="reserved">this</span>.closeButton);
      YAHOO.util.Event.addListener(<span class="reserved">this</span>.closeButton, <span class="literal">"click"</span>, <span class="reserved">this</span>.onCloseButton, <span class="reserved">this</span>, true);
   }
   
   <span class="comment">// Append to the layer element</span>
   <span class="reserved">this</span>.layer.el.appendChild(<span class="reserved">this</span>.el);
   
	<span class="comment">// Set the position</span>
	<span class="reserved">this</span>.el.style.left = <span class="reserved">this</span>.config.position[0]+<span class="literal">"px"</span>;
	<span class="reserved">this</span>.el.style.top = <span class="reserved">this</span>.config.position[1]+<span class="literal">"px"</span>;
};

<span class="comment">/**
 * Sets the content of the body element
 * <span class="attrib">@param</span> {String or DomEl} content
 */</span>
WireIt.Container.<span class="reserved">prototype</span>.setBody = <span class="reserved">function</span>(content) {
   <span class="reserved">if</span>(typeof content == <span class="literal">"string"</span>) {
      <span class="reserved">this</span>.bodyEl.innerHTML = content;
   }
   <span class="reserved">else</span> {
      <span class="reserved">this</span>.bodyEl.innerHTML = <span class="literal">""</span>;
      <span class="reserved">this</span>.bodyEl.appendChild(content);
   }
};


<span class="comment">/**
 * Called when the user made a mouse down on the container and sets the focus to this container (only if within a Layer)
 */</span>
WireIt.Container.<span class="reserved">prototype</span>.onMouseDown = <span class="reserved">function</span>() {
   <span class="reserved">if</span>(<span class="reserved">this</span>.layer) {
      <span class="reserved">if</span>(<span class="reserved">this</span>.layer.focusedContainer &amp;&amp; <span class="reserved">this</span>.layer.focusedContainer != <span class="reserved">this</span>) {
         <span class="reserved">this</span>.layer.focusedContainer.removeFocus();
      }
      <span class="reserved">this</span>.setFocus();
      <span class="reserved">this</span>.layer.focusedContainer = <span class="reserved">this</span>;
   }
};

<span class="comment">/**
 * Adds the class that shows the container as "focused"
 */</span>
WireIt.Container.<span class="reserved">prototype</span>.setFocus = <span class="reserved">function</span>() {
   YAHOO.util.Dom.addClass(<span class="reserved">this</span>.el, <span class="literal">"WireIt-Container-focused"</span>);
};

<span class="comment">/**
 * Remove the class that shows the container as "focused"
 */</span>
WireIt.Container.<span class="reserved">prototype</span>.removeFocus = <span class="reserved">function</span>() {
   YAHOO.util.Dom.removeClass(<span class="reserved">this</span>.el, <span class="literal">"WireIt-Container-focused"</span>);
};

<span class="comment">/**
 * Called when the user clicked on the close button
 */</span>
WireIt.Container.<span class="reserved">prototype</span>.onCloseButton = <span class="reserved">function</span>() {
   <span class="reserved">this</span>.layer.removeContainer(<span class="reserved">this</span>);
};

<span class="comment">/**
 * Remove this container from the dom
 */</span>
WireIt.Container.<span class="reserved">prototype</span>.remove = <span class="reserved">function</span>() {
   
   <span class="comment">// Remove the terminals (and thus remove the wires)</span>
   <span class="reserved">this</span>.removeAllTerminals();
   
   <span class="comment">// Remove from the dom</span>
   <span class="reserved">this</span>.layer.el.removeChild(<span class="reserved">this</span>.el);
};


<span class="comment">/**
 * Call the addTerminal method for each terminal configuration.
 */</span>
WireIt.Container.<span class="reserved">prototype</span>.initTerminals = <span class="reserved">function</span>(terminalConfigs) {
   <span class="reserved">for</span>(var i = 0 ; i &lt; terminalConfigs.length ; i++) {
      <span class="reserved">this</span>.addTerminal(terminalConfigs[i]);
   }
};


<span class="comment">/**
 * Instanciate the terminal from the class pointer "xtype" (default WireIt.Terminal)
 * <span class="attrib">@return</span> {WireIt.Terminal}  terminal Created terminal
 */</span>
WireIt.Container.<span class="reserved">prototype</span>.addTerminal = <span class="reserved">function</span>(terminalConfig) {
   
   <span class="comment">// Terminal type</span>
   var type = eval(terminalConfig.xtype || <span class="literal">"WireIt.Terminal"</span>);
   
   <span class="comment">// Instanciate the terminal</span>
   var term = new type(<span class="reserved">this</span>.el, terminalConfig, <span class="reserved">this</span>);
   
   <span class="comment">// Add the terminal to the list</span>
   <span class="reserved">this</span>.terminals.push( term );
   
   <span class="comment">// Event listeners</span>
   term.eventAddWire.subscribe(<span class="reserved">this</span>.onAddWire, <span class="reserved">this</span>, true);
   term.eventRemoveWire.subscribe(<span class="reserved">this</span>.onRemoveWire, <span class="reserved">this</span>, true);
   
   <span class="reserved">return</span> term;
};

<span class="comment">/**
 * This method is called when a wire is added to one of the terminals
 * <span class="attrib">@param</span> {Event} event The eventAddWire event fired by the terminal
 * <span class="attrib">@param</span> {Array} args This array contains a single element args[0] which is the added Wire instance
 */</span>
WireIt.Container.<span class="reserved">prototype</span>.onAddWire = <span class="reserved">function</span>(event, args) {
   var wire = args[0];
   <span class="comment">// add the wire to the list if it isn't in</span>
   <span class="reserved">if</span>( <span class="reserved">this</span>.wires.indexOf(wire) == -1 ) {
      <span class="reserved">this</span>.wires.push(wire);
      <span class="reserved">this</span>.eventAddWire.fire(wire);
   } 
};

<span class="comment">/**
 * This method is called when a wire is removed from one of the terminals
 * <span class="attrib">@param</span> {Event} event The eventRemoveWire event fired by the terminal
 * <span class="attrib">@param</span> {Array} args This array contains a single element args[0] which is the removed Wire instance
 */</span>
WireIt.Container.<span class="reserved">prototype</span>.onRemoveWire = <span class="reserved">function</span>(event, args) {
   var wire = args[0];
   var index = <span class="reserved">this</span>.wires.indexOf(wire);
   <span class="reserved">if</span>( index != -1 ) {
      <span class="reserved">this</span>.eventRemoveWire.fire(wire);
      <span class="reserved">this</span>.wires[index] = null;
   }
   <span class="reserved">this</span>.wires = <span class="reserved">this</span>.wires.compact();
};

<span class="comment">/**
 * Remove all terminals
 */</span>
WireIt.Container.<span class="reserved">prototype</span>.removeAllTerminals = <span class="reserved">function</span>() {
   <span class="reserved">for</span>(var i = 0 ; i &lt; <span class="reserved">this</span>.terminals.length ; i++) {
      <span class="reserved">this</span>.terminals[i].remove();
   }
   <span class="reserved">this</span>.terminals = [];
};

<span class="comment">/**
 * Redraw all the wires connected to the terminals of this container
 */</span>
WireIt.Container.<span class="reserved">prototype</span>.redrawAllWires = <span class="reserved">function</span>() {
   <span class="reserved">for</span>(var i = 0 ; i &lt; <span class="reserved">this</span>.terminals.length ; i++) {
      <span class="reserved">this</span>.terminals[i].redrawAllWires();
   }
};


<span class="comment">/**
 * Return the config of this container.
 */</span>
WireIt.Container.<span class="reserved">prototype</span>.getConfig = <span class="reserved">function</span>() {
   var obj = {};
   
   <span class="comment">// Position</span>
   obj.position = YAHOO.util.Dom.getXY(<span class="reserved">this</span>.el);
   <span class="reserved">if</span>(<span class="reserved">this</span>.layer) {
      var layerPos = YAHOO.util.Dom.getXY(<span class="reserved">this</span>.layer.el);
      obj.position[0] -= layerPos[0];
      obj.position[1] -= layerPos[1];
   }
   
   <span class="comment">// xtype</span>
   <span class="reserved">if</span>(<span class="reserved">this</span>.config.xtype) {
      obj.xtype = <span class="reserved">this</span>.config.xtype;
   }
   
   <span class="reserved">return</span> obj;
};
</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b>WireIt</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">

</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Sat Jan 26 20:28:08 2008</div>
</body>
</html>
