<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>WireIt Documentation - LayerMap-beta.js</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta name="generator" content="JsDoc Toolkit 2.0.2" />
<link href="css/reset-fonts-grids.css" type="text/css" rel="stylesheet" media="all" /> 
<link href="css/dpSyntaxHighlighter.css" type="text/css" rel="stylesheet" media="all" />
<link href="css/style.css" type="text/css" rel="stylesheet" media="all" />
</head>
<body>
	
	<div id="doc3" class="yui-t2">					
		<div id="hd">
			
			
			<p class='layoutTitle'>WireIt Documentation <span><a href="../../">Back to homepage</a></span></p> 
			
			
			<h3>
				<a href="./index.html">WireIt Documentation</a> &gt; LayerMap-beta.js
				<span class="subtitle">0.3.0</span>
			</h3>
		
		</div>
		<div id="bd">
			<div id="yui-main">
				<div class="yui-b">
<div class="summary description">
	<p>This is the source view for LayerMap-beta.js</p>
</div>
										
<form>
	<textarea name="code" class="JScript">/**
 * @class Widget to display a minimap on a layer (beta)
 * @extends WireIt.CanvasElement
 * @constructor
 * @param  {Obj} options configuration object
 */
WireIt.LayerMap = function(options) {
   
   /**
    * Options:
    * <ul>
    *    <li>layer: the layer object it is attached to</li>
    *    <li>className: default to "WireIt-LayerMap"</li>
    *    <li>style: display style, default to "rgba(0, 0, 200, 0.5)"</li>
    *    <li>ratio: (warning, this might get removed in futur versions)</li>
    *    <li>lineWidth: default 2</li>
    *    <li>width: default 250</li>
    *    <li>height: default 150</li>
    * </ul>
    */
   this.options = options || {};
   this.layer = this.options.layer;
   this.options.className = this.options.className || "WireIt-LayerMap";
   this.options.style = this.options.style || "rgba(0, 0, 200, 0.5)";
   this.options.ratio = this.options.ratio || 0.1;
   this.options.lineWidth = this.options.lineWidth || 2;
   this.options.width = this.options.width || 250;
   this.options.height = this.options.height || 150;
   
   // Create the canvas element
   WireIt.LayerMap.superclass.constructor.call(this);
   
   // Set the className
   this.element.className = this.options.className;
   
   // Set size
   this.element.style.width = this.options.width+"px";
   this.element.style.height = this.options.height+"px";
   
   // Append the canvas to the layer
   this.layer.el.appendChild(this.element);
   
   this.initEvents();
   
   this.draw();
};

YAHOO.lang.extend(WireIt.LayerMap, WireIt.CanvasElement, 
/**
 * @scope WireIt.LayerMap.prototype   
 */   
{
   /**
    * Listen for various events that should redraw the layer map
    */
   initEvents: function() {
      YAHOO.util.Event.addListener(this.element, 'click', this.onClick, this, true);
      
      this.layer.eventAddWire.subscribe(this.draw, this, true);
      this.layer.eventRemoveWire.subscribe(this.draw, this, true);
      this.layer.eventAddContainer.subscribe(this.draw, this, true);
      this.layer.eventRemoveContainer.subscribe(this.draw, this, true);


      this.layer.eventContainerDragged.subscribe(this.draw, this, true);
      this.layer.eventContainerResized.subscribe(this.draw, this, true);
   },
   
   /**
    * When a click event is received
    * @param {Event} e Original event
    * @param {Array} args event parameters
    */
   onClick: function(e, args) { 
      YAHOO.util.Event.stopEvent(e);
      // TODO: move the layer scrollPos ?
   },
   
   /**
    * Redraw the layer map
    */
   draw: function() {
      
      var ctxt=this.getContext();
      
      ctxt.clearRect(0,0,this.options.width,this.options.height);
      
      var ratio = this.options.ratio;
      
      ctxt.fillStyle = this.options.style;
      ctxt.strokeStyle= this.options.style;
      ctxt.lineWidth=this.options.lineWidth;
      
      for(var i = 0 ; i < this.layer.containers.length ; i++) {
         var containerEl = this.layer.containers[i].el;
         
         
         var w = WireIt.getIntStyle(containerEl, "width");
         var h = WireIt.getIntStyle(containerEl, "height");
         var l = WireIt.getIntStyle(containerEl, "left");
         var t = WireIt.getIntStyle(containerEl, "top");
          ctxt.fillRect(l*ratio, t*ratio, w*ratio, h*ratio);
         
      }
      
      for(var i = 0 ; i < this.layer.wires.length ; i++) {
         var wire = this.layer.wires[i];
         var t1 = wire.terminal1, t2 = wire.terminal2;
         var pos1 = t1.getXY(), pos2 = t2.getXY();
      
         // Stroked triangle
         ctxt.beginPath();
         ctxt.moveTo(pos1[0]*ratio,pos1[1]*ratio);
         ctxt.lineTo(pos2[0]*ratio,pos2[1]*ratio);
         ctxt.closePath();
         ctxt.stroke();
      }
      
   }
   
   
});
</textarea>
</form>
					
					
					</div>
			</div>
			
			<div class="yui-b">
				<div class="nav">
					
					<div class="module">
						<h4>Pages</h4>
						<ul class="content">
							
								
								<li>
								<a href="index.html">Index</a></li>
							
								
						</ul>
					</div>
					
					<div class="module">
						<h4>Classes <a href="treeview.html">(treeview)</a></h4>
						<ul class="content">
							
								
								<li>
									<a href="WireIt.html">WireIt</a></li>
							
								
								<li>
									<a href="WireIt.CanvasElement.html">WireIt.CanvasElement</a></li>
							
								
								<li>
									<a href="WireIt.Container.html">WireIt.Container</a></li>
							
								
								<li>
									<a href="WireIt.Layer.html">WireIt.Layer</a></li>
							
								
								<li>
									<a href="WireIt.LayerMap.html">WireIt.LayerMap</a></li>
							
								
								<li>
									<a href="WireIt.Scissors.html">WireIt.Scissors</a></li>
							
								
								<li>
									<a href="WireIt.Terminal.html">WireIt.Terminal</a></li>
							
								
								<li>
									<a href="WireIt.TerminalProxy.html">WireIt.TerminalProxy</a></li>
							
								
								<li>
									<a href="WireIt.util.html">WireIt.util</a></li>
							
								
								<li>
									<a href="WireIt.util.Anim.html">WireIt.util.Anim</a></li>
							
								
								<li>
									<a href="WireIt.util.DD.html">WireIt.util.DD</a></li>
							
								
								<li>
									<a href="WireIt.util.DDResize.html">WireIt.util.DDResize</a></li>
							
								
								<li>
									<a href="WireIt.util.TerminalInput.html">WireIt.util.TerminalInput</a></li>
							
								
								<li>
									<a href="WireIt.util.TerminalOutput.html">WireIt.util.TerminalOutput</a></li>
							
								
								<li>
									<a href="WireIt.Wire.html">WireIt.Wire</a></li>
							
								
						</ul>
					</div>
					
					<div class="module">
						<h4>Files</h4>
						<ul class="content">
							
								
								<li>
								<a href="Anim.js.html">Anim.js</a></li>
							
								
								<li>
								<a href="CanvasElement.js.html">CanvasElement.js</a></li>
							
								
								<li>
								<a href="Container.js.html">Container.js</a></li>
							
								
								<li>
								<a href="DD.js.html">DD.js</a></li>
							
								
								<li>
								<a href="DDResize.js.html">DDResize.js</a></li>
							
								
								<li>
								<a href="Layer.js.html">Layer.js</a></li>
							
								<li class="selected">
								
								<a href="LayerMap-beta.js.html">LayerMap-beta.js</a></li>
							
								
								<li>
								<a href="Terminal.js.html">Terminal.js</a></li>
							
								
								<li>
								<a href="Wire.js.html">Wire.js</a></li>
							
								
								<li>
								<a href="WireIt.js.html">WireIt.js</a></li>
							
						</ul>
					</div>
					
				</div>
			</div>
		</div>
		
		
		<div id="ft">
			<hr/>
			Copyright (c) 2007-2008 <a href='http://javascript.neyric.com' target='_new'>Eric Abouaf</a>. All rights reserved.<br />
			Generated by <a href="http://jsdoctoolkit.org/" target="_blank">JsDoc Toolkit</a> 2.0.2 on Sun, 12 Oct 2008 17:55:43 GMT using <a href="http://code.google.com/p/neyricjslibs-template/" target="_blank">neyricjslibs-template</a>.
		</div>
		
	</div>

<script src="js/dpSyntaxHighlighter.js" type="text/javascript"></script>
<script language="javascript"> 
dp.SyntaxHighlighter.HighlightAll('code');
</script>
</body>
</html>