<!doctype html public "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<html>
<head>
<title>
WireIt Overview
</title>
<link rel ="stylesheet" type="text/css" href="stylesheet.css" title="Style">
<script>
function asd() {
	
		parent.document.title="Wire.js Overview";
	
}
</script>
</head>
<body bgcolor="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> 	<font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top">
<em>
<b>WireIt</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<center>
	
	   <h2>Wire.js</h2>
	
</center>

	


<h4>Summary</h4>
<p>
	
		Defines the Wire class that wraps a canvas tag to create wires.<BR/><BR/>
	
</p>

<hr>


    <table border="1" cellpadding="3" cellspacing="0" width="100%">
    <tr bgcolor="#CCCCFF" class="TableHeadingColor">
    <td colspan=2><font size="+2">
    
        <b>Class Summary</b>
    
    </font></td>
    </tr>
    
    <tr bgcolor="white" class="TableRowColor">
    <td width="15%"><b><a href="WireIt/Wire.html">WireIt.Wire</a></b></td>
    <td>WireIt.Wire
 </td>
    </tr>
    
    </table>
    <hr/> 


<!-- ========== METHOD SUMMARY =========== -->

<!-- ========== END METHOD SUMMARY =========== -->


        <pre class="sourceview"><span class="comment">/**
 * <span class="attrib">@fileoverview</span> Defines the Wire class that wraps a canvas tag to create wires.
 */</span>
<span class="comment">/**
 * <span class="attrib">@class</span> WireIt.Wire
 * <span class="attrib">@constructor</span>
 *
 * <span class="attrib">@param</span>  {WireIt.Terminal}    terminal1   Source terminal
 * <span class="attrib">@param</span>  {WireIt.Terminal}    terminal2   Target terminal
 * <span class="attrib">@param</span>  {DomEl}              parentEl    Container of the CANVAS tag
 * <span class="attrib">@param</span>  {Obj}                config      Styling configuration
 */</span>
WireIt.Wire = <span class="reserved">function</span>( terminal1, terminal2, parentEl, config) {
   
   <span class="comment">/**
    * Reference to the parent dom element
    */</span>
   <span class="reserved">this</span>.parentEl = parentEl;
   
   <span class="comment">/**
    * Reference to the first terminal
    */</span>
   <span class="reserved">this</span>.terminal1 = terminal1;
   
   <span class="comment">/**
    * Reference to the second terminal
    */</span>
   <span class="reserved">this</span>.terminal2 = terminal2;
   
   <span class="comment">/**
    * Wire styling, and properties:
    * &lt;ul&gt;
    *   &lt;li&gt;className: CSS class name of the canvas element (default 'WireIt-Wire')&lt;/li&gt;
    *   &lt;li&gt;coeffMulDirection: Parameter for bezier style&lt;/li&gt;
    *   &lt;li&gt;cap: default 'round'&lt;/li&gt;
    *   &lt;li&gt;bordercap: default 'round'&lt;/li&gt;
    *   &lt;li&gt;width: Wire width (default to 3)&lt;/li&gt;
    *   &lt;li&gt;borderwidth: Border Width (default to 1)&lt;/li&gt;
    *   &lt;li&gt;color: Wire color (default to rgb(173, 216, 230) )&lt;/li&gt;
    *   &lt;li&gt;bordercolor: Border color (default to #0000ff )&lt;/li&gt;
    * &lt;/ul&gt;
    */</span>
   <span class="reserved">this</span>.config = config || {};
   <span class="reserved">this</span>.config.className = <span class="reserved">this</span>.config.className || <span class="literal">'WireIt-Wire'</span>;
   <span class="reserved">this</span>.config.coeffMulDirection = YAHOO.lang.isUndefined(<span class="reserved">this</span>.config.coeffMulDirection) ? 100 : <span class="reserved">this</span>.config.coeffMulDirection;
   
   <span class="comment">// Syling</span>
   <span class="reserved">this</span>.config.cap = <span class="reserved">this</span>.config.cap || <span class="literal">'round'</span>;
   <span class="reserved">this</span>.config.bordercap = <span class="reserved">this</span>.config.bordercap || <span class="literal">'round'</span>;
   <span class="reserved">this</span>.config.width = <span class="reserved">this</span>.config.width || 3;
   <span class="reserved">this</span>.config.borderwidth = <span class="reserved">this</span>.config.borderwidth || 1;
   <span class="reserved">this</span>.config.color = <span class="reserved">this</span>.config.color || <span class="literal">'rgb(173, 216, 230)'</span>;
   <span class="reserved">this</span>.config.bordercolor = <span class="reserved">this</span>.config.bordercolor || <span class="literal">'#0000ff'</span>;
   
   
   <span class="comment">// Render the wire</span>
   <span class="reserved">this</span>.render();
   
   <span class="comment">// Call addWire on both terminals</span>
   <span class="reserved">this</span>.terminal1.addWire(<span class="reserved">this</span>);
   <span class="reserved">this</span>.terminal2.addWire(<span class="reserved">this</span>);
};


<span class="comment">/**
 * Render the canvas tag
 */</span>
WireIt.Wire.<span class="reserved">prototype</span>.render = <span class="reserved">function</span>() {
   
   <span class="comment">// Create the canvas element</span>
   <span class="reserved">this</span>.el = WireIt.cn(<span class="literal">"canvas"</span>, {className: <span class="reserved">this</span>.config.className});
   
   <span class="comment">// Append the canvas to the parent element</span>
   <span class="reserved">this</span>.parentEl.appendChild(<span class="reserved">this</span>.el);
   
   <span class="comment">// excanvas.js for dynamic canvas tags</span>
   <span class="reserved">if</span>(typeof (G_vmlCanvasManager)!=<span class="literal">"undefined"</span>){
      <span class="reserved">this</span>.el = G_vmlCanvasManager.initElement(<span class="reserved">this</span>.el);
   }
};

<span class="comment">/**
 * Remove a Wire from the Dom
 */</span>
WireIt.Wire.<span class="reserved">prototype</span>.remove = <span class="reserved">function</span>() {
   
   <span class="comment">// Remove the canvas from the dom</span>
   <span class="reserved">this</span>.parentEl.removeChild(<span class="reserved">this</span>.el);
   
   <span class="comment">// Remove the wire reference from the connected terminals</span>
   <span class="reserved">if</span>(<span class="reserved">this</span>.terminal1 &amp;&amp; <span class="reserved">this</span>.terminal1.removeWire) {
      <span class="reserved">this</span>.terminal1.removeWire(<span class="reserved">this</span>);
   }
   <span class="reserved">if</span>(<span class="reserved">this</span>.terminal2 &amp;&amp; <span class="reserved">this</span>.terminal2.removeWire) {
      <span class="reserved">this</span>.terminal2.removeWire(<span class="reserved">this</span>);
   }
   
   <span class="comment">// Remove references to old terminals</span>
   <span class="reserved">this</span>.terminal1 = null;
   <span class="reserved">this</span>.terminal2 = null;
};

<span class="comment">/**
 * Redraw the Wire
 */</span>
WireIt.Wire.<span class="reserved">prototype</span>.redraw = <span class="reserved">function</span>() {
   
   <span class="comment">// Get the positions of the terminals</span>
   var p1 = <span class="reserved">this</span>.terminal1.getXY();
   var p2 = <span class="reserved">this</span>.terminal2.getXY();
   
   <span class="comment">// Coefficient multiplicateur de direction</span>
   <span class="comment">// 100 par d√©faut, si distance(p1,p2) &lt; 100, on passe en distance/2</span>
   var coeffMulDirection=<span class="reserved">this</span>.config.coeffMulDirection;
   
   
   var distance=Math.sqrt(Math.pow(p1[0]-p2[0],2)+Math.pow(p1[1]-p2[1],2));
   <span class="reserved">if</span>(distance &lt; coeffMulDirection){
      coeffMulDirection=distance/2;
   }
   
   <span class="comment">// Calcul des vecteurs directeurs d1 et d2 :</span>
   var d1=[<span class="reserved">this</span>.terminal1.config.direction[0]*coeffMulDirection,<span class="reserved">this</span>.terminal1.config.direction[1]*coeffMulDirection];
   var d2=[<span class="reserved">this</span>.terminal2.config.direction[0]*coeffMulDirection,<span class="reserved">this</span>.terminal2.config.direction[1]*coeffMulDirection];
   
   var bezierPoints=[];
   bezierPoints[0]=p1;
   bezierPoints[1]=[p1[0]+d1[0],p1[1]+d1[1]];
   bezierPoints[2]=[p2[0]+d2[0],p2[1]+d2[1]];
   bezierPoints[3]=p2;
   var min=[p1[0],p1[1]];
   var max=[p1[0],p1[1]];
   <span class="reserved">for</span>(var i=1;i&lt;bezierPoints.length;i++){
      var p=bezierPoints[i];
      <span class="reserved">if</span>(p[0]&lt;min[0]){
         min[0]=p[0];
      }
      <span class="reserved">if</span>(p[1]&lt;min[1]){
         min[1]=p[1];
      }
      <span class="reserved">if</span>(p[0]&gt;max[0]){
         max[0]=p[0];
      }
      <span class="reserved">if</span>(p[1]&gt;max[1]){
         max[1]=p[1];
      }
   }
   <span class="comment">// Redimensionnement du canvas</span>
   var margin=[4,4];
   min[0]=min[0]-margin[0];
   min[1]=min[1]-margin[1];
   max[0]=max[0]+margin[0];
   max[1]=max[1]+margin[1];
   var lw=Math.abs(max[0]-min[0]);
   var lh=Math.abs(max[1]-min[1]);
   
   <span class="reserved">this</span>.el= WireIt.SetCanvasRegion(<span class="reserved">this</span>.el,min[0],min[1],lw,lh);
   
   var ctxt=<span class="reserved">this</span>.el.getContext(<span class="literal">"2d"</span>);
   <span class="reserved">for</span>(var i=0;i&lt;bezierPoints.length;i++){
      bezierPoints[i][0]=bezierPoints[i][0]-min[0];
      bezierPoints[i][1]=bezierPoints[i][1]-min[1];
   }
   
   <span class="comment">// Draw the border</span>
   ctxt.lineCap=<span class="reserved">this</span>.config.bordercap;
   ctxt.strokeStyle=<span class="reserved">this</span>.config.bordercolor;
   ctxt.lineWidth=<span class="reserved">this</span>.config.width+<span class="reserved">this</span>.config.borderwidth*2;
   ctxt.beginPath();
   ctxt.moveTo(bezierPoints[0][0],bezierPoints[0][1]);
   ctxt.bezierCurveTo(bezierPoints[1][0],bezierPoints[1][1],bezierPoints[2][0],bezierPoints[2][1],bezierPoints[3][0],bezierPoints[3][1]);
   ctxt.stroke();
   
   <span class="comment">// Draw the inner bezier curve</span>
   ctxt.lineCap=<span class="reserved">this</span>.config.cap;
   ctxt.strokeStyle=<span class="reserved">this</span>.config.color;
   ctxt.lineWidth=<span class="reserved">this</span>.config.width;
   ctxt.beginPath();
   ctxt.moveTo(bezierPoints[0][0],bezierPoints[0][1]);
   ctxt.bezierCurveTo(bezierPoints[1][0],bezierPoints[1][1],bezierPoints[2][0],bezierPoints[2][1],bezierPoints[3][0],bezierPoints[3][1]);
   ctxt.stroke();
   
};


<span class="comment">/**
 * This function returns terminal1 if the first argument is terminal2 and vice-versa
 * <span class="attrib">@param</span>   {WireIt.Terminal} terminal    
 * <span class="attrib">@return</span>  {WireIt.Terminal} terminal    the terminal that is NOT passed as argument
 */</span>
WireIt.Wire.<span class="reserved">prototype</span>.getOtherTerminal = <span class="reserved">function</span>(terminal) {
   <span class="reserved">return</span> (terminal == <span class="reserved">this</span>.terminal1) ? <span class="reserved">this</span>.terminal2 : <span class="reserved">this</span>.terminal1;
};
</pre>
	<hr>



<!-- ========== START OF NAVBAR ========== -->
<a name="navbar_top"><!-- --></a>
<table border="0" width="100%" cellpadding="1" cellspacing="0">
<tr>
<td colspan=2 bgcolor="#EEEEFF" class="NavBarCell1">
<a name="navbar_top_firstrow"><!-- --></a>
<table border="0" cellpadding="0" cellspacing="3">
  <tr align="center" valign="top">
  
  
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-summary.html"><font class="NavBarFont1"><b>Overview</b></font></a>&nbsp;</td>
  <td bgcolor="#FFFFFF" class="NavBarCell1Rev">	&nbsp;<font class="NavBarFont1Rev"><b>File</b></font>&nbsp;</td>
  

  <td bgcolor="#FFFFFF" class="NavBarCell1"> <font class="NavBarFont1">Class</font>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="overview-tree.html"><font class="NavBarFont1"><b>Tree</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="index-all.html"--><font class="NavBarFont1"><b>Index</b></font></a>&nbsp;</td>
  <td bgcolor="#EEEEFF" class="NavBarCell1">    <a href="help-doc.html"><font class="NavBarFont1"><b>Help</b></font></a>&nbsp;</td>
  </tr>
</table>
</td>
<td bgcolor="#EEEEFF" align="right" valign="top"><em>
<b>WireIt</b></em>
</td>
</tr>

<tr>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
&nbsp;PREV&nbsp;
&nbsp;NEXT</font></td>
<td bgcolor="white" class="NavBarCell2"><font size="-2">
  <a href="index.html" target="_top"><b>FRAMES</b></a>  &nbsp;
&nbsp;<a href="overview-summary.html" target="_top"><b>NO FRAMES</b></a>
&nbsp;&nbsp;
<script>
  <!--
  if(window==top) {
    document.writeln('<A HREF="allclasses-noframe.html" TARGET=""><B>All Classes</B></A>');
  }
  //-->
</script>
<noscript>
<a href="allclasses-noframe.html" target=""><b>All Classes</b></a>
</noscript>
</font></td>
</tr>
</table>
<!-- =========== END OF NAVBAR =========== -->

<hr>
<font size="-1">

</font>
<div class="jsdoc_ctime">Documentation generated by <a href="http://jsdoc.sourceforge.net/" target="_parent">JSDoc</a> on Sat Jan 26 15:17:14 2008</div>
</body>
</html>
