<?xml version="1.0" encoding="UTF-8"?>
<html>
 <head>
  <title>WireIt: Example 5</title>
  
<!-- YUI -->
<link rel="stylesheet" type="text/css" href="../lib/yui/fonts/fonts-min.css" /> 
<link rel="stylesheet" type="text/css" href="../lib/yui/reset/reset-min.css" />

<script type="text/javascript" src="../lib/yui/yahoo/yahoo-min.js"></script> 
<script type="text/javascript" src="../lib/yui/dom/dom-min.js"></script> 
<script type="text/javascript" src="../lib/yui/event/event-min.js"></script>  
<script type="text/javascript" src="../lib/yui/dragdrop/dragdrop-min.js"></script>

<!-- Excanvas -->
<script type="text/javascript" src="../lib/excanvas.js"></script>

<!-- WireIt -->
<script type="text/javascript" src="../js/WireIt.js"></script>
<script type="text/javascript" src="../js/Wire.js"></script>
<script type="text/javascript" src="../js/Terminal.js"></script>
<script type="text/javascript" src="../js/util/DD.js"></script>

<link rel="stylesheet" type="text/css" href="../css/WireIt.css" />

<style>

div.bubble {
	width: 30px;
	height: 28px;
	position: relative;
	z-index: 5;
	opacity: 0.8;
	cursor: move;
}

div.bubble .quarter {
	width: 15px;
	height: 14px;
	position: absolute;
}
div.bubble .tl {
	background-image: url(images/bubble_tl.png);
	left: 0; top: 0;
}
div.bubble .tr {
	background-image: url(images/bubble_tr.png);
	left: 15px; top: 0;
}
div.bubble .bl {
	background-image: url(images/bubble_bl.png);
	left: 0; top: 14px;
}
div.bubble .br {
	background-image: url(images/bubble_br.png);
	left: 15px; top: 14px;
}

div.bubble div.WireIt-Terminal {
	position: absolute;
}

</style>

<script>

var Bubble = function(id, position) {
	this.id = id;
	
	// Create the main bubble div
	this.el = WireIt.cn('div', {id: this.id, className: "bubble"});
	// Create 4 divs to place the images
	var classNames = ["tl","tr","bl","br"];
	for(var i = 0 ; i < 4 ; i++) {
		this.el.appendChild(WireIt.cn('div', {className: "quarter "+classNames[i]}) );
	}
	document.body.appendChild(this.el);
	
	// Create the 4 terminals
	var terminalConfigs = [{direction: [-1,-1], offsetPosition: [-5,-5]},
								  {direction: [1,-1], offsetPosition: [20,-5]},
								  {direction: [-1,1], offsetPosition: [-5,20]},
								  {direction: [1,1], offsetPosition: [20,20]}];
	this.terminals = [];
	for(i = 0 ; i < 4 ; i++) {
		this.terminals[i] = new WireIt.Terminal(this.el, terminalConfigs[i]);
	}						
	
	// Make Drag/drop !
	new WireIt.util.DD(this.terminals,this.el);
	
	// Position the bubble
	if(position) {
		YAHOO.util.Dom.setXY(this.el, position);
	}
};


var Nbubbles = 0;
function createBubble(position) {
	return new Bubble('bubble'+(Nbubbles++), position);
};

window.onload = function() {	
	var b1 = createBubble([335,60]);
	var b2 = createBubble([280,150]);
	var b3 = createBubble([380,150]);
	var bubbles = [b1,b2,b3];
	
	var wires = [ [[0,3],[2,0]] , [[0,2],[1,1]] , [[1,3],[2,2]] , [[0,0],[1,0]], [[1,2],[2,3]] , [[0,1],[2,1]] ];
	
	for(var i = 0 ; i < wires.length ; i++) {
		var wire = wires[i];
		var src = wire[0];
		var tgt = wire[1];
		var w = new WireIt.Wire( bubbles[src[0]].terminals[src[1]] , bubbles[tgt[0]].terminals[tgt[1]], document.body);
		w.redraw();
	}
	
};

</script>
 </head>
 <body>
	
	<p style="margin: 15px;">Terminal directions can be changed !</p>
	
	<button style="margin: 15px;" onclick='createBubble();'>Add a Bubble</button>
	
 </body>
</html>